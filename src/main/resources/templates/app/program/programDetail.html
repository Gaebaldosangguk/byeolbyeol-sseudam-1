<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>별별쓰담 | 쓰담학교</title>
    <link rel="stylesheet" href="/css/fix/font.css">
    <link rel="stylesheet" href="/css/Program/programDetail.css">
    <link rel="stylesheet" href="/css/fix/header68.css">
    <link rel="stylesheet" href="/css/fix/header74.css">
    <link rel="stylesheet" href="/css/fix/header51.css">
    <link rel="stylesheet" href="/css/fix/header76.css">
    <link rel="stylesheet" href="/css/fix/header77.css">
    <link rel="stylesheet" href="/css/fix/header37.css">
    <link rel="stylesheet" href="/css/fix/footer1.css">
    <link rel="stylesheet" href="/css/fix/footer2.css">
    <link rel="icon" href="/images/fix/favicon.png">
</head>

<body>

<!-- 로그인 확인 모달창 -->
<div class="swal2-container swal2-center sg-swal swal2-shown" style="overflow-y: auto;">
    <div aria-labelledby="swal2-title" aria-describedby="swal2-content" class="swal2-popup swal2-modal swal2-show"
         tabindex="-1" role="dialog" aria-live="assertive" aria-modal="true" style="width: 320px; display: flex; border-radius: 10px;">
        <div class="swal2-header">
            <ul class="swal2-progress-steps" style="display: none;"></ul>
            <div class="swal2-icon swal2-error" style="display: none;"><span class="swal2-x-mark"><span
                    class="swal2-x-mark-line-left"></span><span class="swal2-x-mark-line-right"></span></span>
            </div>
            <div class="swal2-icon swal2-question" style="display: none;"></div>
            <div class="swal2-icon swal2-warning" style="display: none;"></div>
            <div class="swal2-icon swal2-info" style="display: none;"></div>
            <div class="swal2-icon swal2-success" style="display: none;">
                <div class="swal2-success-circular-line-left"></div>
                <span class="swal2-success-line-tip"></span>
                <span class="swal2-success-line-long"></span>
                <div class="swal2-success-ring"></div>
                <div class="swal2-success-fix"></div>
                <div class="swal2-success-circular-line-right"></div>
            </div>
            <img class="swal2-image" style="display: none;">
            <h2 class="swal2-title" id="swal2-title" style="display: flex;">로그인 필요</h2>
            <button type="button" class="swal2-close" aria-label="Close this dialog" style="display: none;">×
            </button>
        </div>
        <div class="swal2-content">
            <div id="swal2-content" style="display: block;">로그인 후 서비스를 이용할 수 있습니다.</div>
            <input class="swal2-input" style="display: none;"><input type="file" class="swal2-file"
                                                                     style="display: none;">
            <div class="swal2-range" style="display: none;"><input type="range">
                <output></output>
            </div>
            <select class="swal2-select" style="display: none;"></select>
            <div class="swal2-radio" style="display: none;"></div>
            <label class="swal2-checkbox" style="display: none;"><input type="checkbox"><span
                    class="swal2-label"></span></label><textarea class="swal2-textarea"
                                                                 style="display: none;"></textarea>
            <div class="swal2-validation-message" id="swal2-validation-message"></div>
        </div>
        <div class="swal2-actions">
            <button type="button" class="swal2-confirm btn" aria-label="" style="display: inline-block;"
                    onclick="goLogin()">로그인/회원가입
            </button>
            <button type="button" class="swal2-cancel btn" aria-label="" style="display: inline-block;"
                    onclick="history.go(0);">취소
            </button>
        </div>
        <input type="hidden" id="sessionMember" value="">
        <div class="swal2-footer" style="display: none;"></div>
    </div>
</div>


<div>
    <th:block th:if="${session.member == null}">
        <header th:replace="/app/fix/header.html :: header"></header>
    </th:block>
    <th:block th:if="${session.member != null}">
        <header th:replace="/app/fix/headerLogin.html :: header"></header>
    </th:block>

    <div id="app-body">
        <div class="instant-purchase-container">
            <article class="instant-purchase-product-detail no-recent-view" data-v-08563466="">
                <div class="flex-aside left" data-v-08563466="">
                    <div class="observer-container" data-v-e0e63576="" data-v-08563466="">
                        <section class="banner" data-v-e0e63576="" data-v-08563466="">
                            <article data-v-5a004a22="" data-v-08563466="" data-v-e0e63576="">
                                <div class="slick-slider slick-initialized" data-v-3d1a4f76="" data-v-55917fe8=""
                                     data-v-5a004a22="">
                                    <div class="slick-list" data-v-3d1a4f76="">
                                        <div class="slick-track"
                                             style="width: 600px; opacity: 1; transform: translate3d(0px, 0px, 0px);"
                                             data-v-e4caeaf8="" data-v-3d1a4f76="">
                                            <div tabindex="-1" data-index="0" aria-hidden="false"
                                                 class="slick-slide slick-active slick-current"
                                                 style="outline: none; width: 600px;" data-v-e4caeaf8="">
                                                <div data-v-e4caeaf8="">

                                                    <article tabindex="-1" class="preview-image"
                                                             style="width:100%;display:inline-block;" data-v-1a98b297=""
                                                             data-v-5a004a22="" data-v-e4caeaf8="">
                                                        <div class="image-wrap" style=""
                                                             data-v-1a98b297="">
<!--                                                            <img th:src="${program.programFileDetailPath}"-->
<!--                                                                 style="width: 600px;">-->
                                                            <img th:src="${program.programFileDetailName}"
                                                                 style="width: 600px;">.
                                                            <!--                                                            <img src="/images/program/program1-1.png"-->
                                                            <!--                                                                 style="width: 600px;">-->

                                                        </div>
                                                        <!---->
                                                        <!---->
                                                        <!---->
                                                    </article>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!---->
                            </article>
                        </section>

                        <!---->
                        <!---->
                    </div>
                </div>
                <div class="flex-aside right" data-v-08563466="">
                    <div class="product-controller" data-v-08563466="" style="background: #fff;">


                        <!-- program detail start-->
                        <!-- program detail start-->
                        <!-- program detail start-->


                        <section th:object="${program}" class="program detail">

                            <!--                            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!-->
                            <!--                            !!!!!!!!!!!!!!!로그인 완료 되면 확인하기!!!!!!!!!!!!!!!-->
                            <!--                            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!-->
                            <th:block th:if="${session.member != null}">
                                <input type="hidden" class="memberIdSession" th:href="${session.member.memberId}">
                            </th:block>

                            <input type="hidden" class="programId" th:href="*{programId}">


                            <header id="good_header">
                                <div class="view_tit no-margin-top title_font_style "
                                     style="color: #454545; font-size: 16px !important; margin-bottom: 5px;">
                                    <span th:text="*{programName}"></span><br>
                                    <div class="ns-icon inline-blocked clearfix">
                                        <!--                                        <th:block th:if="${#strings.equals(program.programStatus.toString(), '모집중')}">-->
                                        <!--                                            <div class="programStatusIcon blueIcon">모집중</div>-->
                                        <!--                                        </th:block>-->
                                        <!--                                        <th:block th:if="${#strings.equals(program.programStatus.toString(), '모집예정')}">-->
                                        <!--                                            <div class="programStatusIcon greenIcon">모집예정</div>-->
                                        <!--                                        </th:block>-->
                                        <!--                                        <th:block th:if="${#strings.equals(program.programStatus.toString(), '모집완료')}">-->
                                        <!--                                            <div class="programStatusIcon redIcon">모집완료</div>-->
                                        <!--                                        </th:block>-->
                                        <!--                                        <th:block th:if="${#strings.equals(program.programStatus.toString(), '마감')}">-->
                                        <!--                                            <div class="programStatusIcon grayIcon">마감</div>-->
                                        <!--                                        </th:block>-->

                                        <div th:if="${#strings.equals(program.programStatus, '모집중')}"
                                             class="programStatusIcon blueIcon">모집중
                                        </div>
                                        <div th:if="${#strings.equals(program.programStatus, '모집예정')}"
                                             class="programStatusIcon greenIcon">모집예정
                                        </div>
                                        <div th:if="${#strings.equals(program.programStatus, '모집완료')}"
                                             class="programStatusIcon redIcon">모집완료
                                        </div>
                                        <div th:if="${#strings.equals(program.programStatus, '마감')}"
                                             class="programStatusIcon grayIcon">마감
                                        </div>
                                        <input type="hidden" class="programStatus" th:href="*{programStatus}">
                                    </div>
                                </div>
                            </header>
                            <div class="col-md-6 col-sm-12 col-xs-12  goods_form_wrap" id="scroll">
                                <div class="goods_form" id="prod_goods_form">
                                    <div class="goods_summary body_font_color_70">
                                        <div class="fr-view">
                                            <p th:text="*{programName}" class="black"></p>
                                            <ul style="list-style-type: circle;">
                                                <li>내용 :
                                                    <p th:text="' - '+*{programContent}" class="black"></p>
                                                </li>
                                                <li>일시 :
                                                    <p th:text="' - '+${#temporals.format(program.programDate, 'yyyy년 MM월 dd일 HH:mm')}"
                                                       class="black"></p>
                                                </li>
                                                <li>장소 :
                                                    <p th:text="' - '+*{programPlace}" class="black"></p>
                                                </li>
                                                <li>수강 가능 인원 :
                                                    <p th:text="' - '+*{programLimitCount}+' 명'" class="black"></p>
                                                </li>
                                                <li>수강 소요 시간 :
                                                    <p th:text="' - '+*{programTime}+' (시간)'" class="black"></p>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <i aria-hidden="true"
                                       class="wish-icon-s20221006e0ef8439338fd im-icon im-ico-like text-18"></i>
                                    </a>
                                </div>
                                <div class="item_detail">
                                    <div class="_item_detail_wrap">
                                        <div class="margin-bottom-xxl">

                                            <!--                                            <div class="option_wrap" style="display: block; font-size:13px;margin-bottom: 10px;">-->
                                            <!--                                                <div class="inline-blocked vertical-middle">-->
                                            <!--                                                    <span class="option_title text-bold">현재 신청 인원 수</span>-->
                                            <!--                                                </div>-->
                                            <!--                                                <div class="inline-blocked vertical-middle">-->
                                            <!--                                                    <span class="option_data">22 명</span>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <div class="" style="font-size:13px;">
                                                <div class="inline-blocked vertical-middle">
                                                    <span class="option_title text-bold">모집 시작일</span>
                                                </div>
                                                <div class="inline-blocked vertical-middle">
                                                    <span th:text="' '+${#temporals.format(program.openingDate, 'yyyy년 MM월 dd일 HH:mm')}"
                                                          class="option_data"></span>
                                                </div>
                                            </div>
                                            <div class="" style="font-size:13px;">
                                                <div class="inline-blocked vertical-middle">
                                                    <span class="option_title text-bold">모집 마감일</span>
                                                </div>
                                                <div class="inline-blocked vertical-middle">
                                                    <span th:text="' '+${#temporals.format(program.closingDate, 'yyyy년 MM월 dd일 HH:mm')}"
                                                          class="option_data"></span>
                                                </div>
                                            </div>
                                        </div>


                                        <!-- select Time -->
                                        <!-- select Time -->
                                        <!-- select Time -->
                                        <!-- select Time -->
                                        <!-- select Time -->


                                        <!--                <div id="inputbox">-->
                                        <!--                    -->
                                        <!--                    <div id="margindiv">-->
                                        <!--                        -->
                                        <!--                        <span class="option_title text-bold" style="font-size: 13px;">시간 선택 *</span>-->
                                        <!--                    </div>-->
                                        <!--                   -->
                                        <!--                    <form>-->
                                        <!--                        <select name="timeSelect" style="font-size: 14px;-->
                                        <!--                        width: 300px;-->
                                        <!--                        height: 35px;-->
                                        <!--                        margin-bottom: 15px;" >-->
                                        <!--                        -->
                                        <!--                          <option value="none">=== 선택 ===</option>-->
                                        <!--                          <option value="" selected>시간 선택(필수)</option>-->
                                        <!--                          <option value="time">오전반 | 10월22일(토) 11-13시</option>-->
                                        <!--                          <option value="time">오후반 | 10월22일(토) 15-17시</option>-->
                                        <!--                        </select>-->
                                        <!--                      </form>-->
                                        <!--            -->
                                        <!--                        </div>-->


                                        <!-- select Time -->
                                        <!-- select Time -->
                                        <!-- select Time -->
                                        <!-- select Time -->
                                        <!-- select Time -->


                                    </div>
                                </div>
                            </div>


                        </section>


                        <!-- program detail end-->
                        <!-- program detail end-->
                        <!-- program detail end-->

                        <section class="buy-button pb-0" data-v-08563466="">
                            <!---->
                            <div class="sticky-btn-group" data-v-08563466=""><!--<button type="button"
                                    class="btn btn-qna btn-none btn-block" data-v-fa78c050="" data-v-08563466=""><span
                                        data-v-fa78c050="" data-v-08563466="">문의</span></button>-->
                                <button
                                        data-testid="purchase-btn" type="button" class="btn btn-buy btn-primary bigBtn"
                                        id="Apply"
                                        data-v-08563466="" style="font-size: 16px" >
                                    신청하기
                                </button>
                                <input type="hidden" id="programLimitCount" th:href="${program.programLimitCount}">
                            </div>
                        </section>
                        <img src="/images/program/000program.png" style="margin-top: 10px;border-radius: 12px; width: 100%;">
                        <!--<figure class="guarantee-banner" data-v-4df1822e="" data-v-08563466=""><img alt="숨고보증"
                                data-v-4df1822e=""
                                data-src="https://assets.cdn.soomgo.com/images/instant-purchase/img-guarantee-product.svg"
                                src="https://assets.cdn.soomgo.com/images/instant-purchase/img-guarantee-product.svg"
                                lazy="loaded">
                            <figcaption data-v-4df1822e=""><strong data-v-4df1822e="">안심하세요 숨고가 보상해드려요!</strong>
                                <p data-v-4df1822e="">최대 1,000만 원까지 보상</p>
                            </figcaption>
                            &lt;!&ndash;&ndash;&gt;
                        </figure>-->
                    </div>
                </div>
                <!---->
                <!---->
                <!---->
                <!-- Modal -->
                <!-- Modal -->
                <!-- Modal -->

                <div class="modal">
                    <div class="modal_content"
                         title="클릭하면 창이 닫힙니다.">

                        <div style="position: relative;
                         top: 6%;">

                            <div id="modal_title" class="view_tit no-margin-top title_font_style "
                                 style="color: #656565; font-size: 20px !important; margin-bottom: 5px; text-align: center;">
                                신청 하시겠습니까?

                            </div>

                            <div id="__BVID__125___BV_modal_content_" tabindex="-1" class="modal-content">
                                <!--  <div data-v-af4658e8="" class="information-use-box"><p data-v-af4658e8="" class="information-use-content">
                                      <span data-v-af4658e8="" class="emoji">🔗</span>
                                      <span data-v-af4658e8="" class="text">영리목적으로 정보를 공유하는 행위</span></p>
                                      <p data-v-af4658e8="" class="information-use-content"><span data-v-af4658e8="" class="emoji">🤬</span>
                                          <span data-v-af4658e8="" class="text">욕설, 과도한 비방글, 저격글, 혐오표현</span></p>
                                          <p data-v-af4658e8="" class="information-use-content"><span data-v-af4658e8="" class="emoji">✋</span>
                                              <span data-v-af4658e8="" class="text">다른 회원의 수업을 방해하는 행위</span></p>
                                          </div><div data-v-af4658e8="" class="footer-button"></div>&lt;!&ndash;&ndash;&gt;</div>-->


                                <br>

                                <div id="button_Disply" style="display: flex;
                        justify-content: space-evenly;">

                                    <button data-testid="purchase-btn" type="button" class="btn btn-buy btn-primary"
                                            style="background: #00c7ae; border-radius: 0.25rem; "
                                            onclick="insertProgram();">
                                        신청하기
                                    </button>

                                    <button data-testid="purchase-btn" type="button" class="btn btn-buy btn-primary"
                                            style="background: #00c7ae; border-radius: 0.25rem;"
                                            onclick="history.go(0);">
                                        돌아가기
                                    </button>

                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Modal -->
                    <!-- Modal -->
                    <!-- Modal -->


                    <div class="v-portal" style="display:none;" data-v-08563466=""></div>
                </div>
            </article>
        </div>
    </div>
</div>
<th:block th:if="${session.member != null}">
    <input type="hidden" th:value="${session.member.memberId}" name="memberId">
    <input type="hidden" th:value="${session.member.memberCategory}" name="memberCategory">
    <input type="hidden" th:value="${check}" name="check">
</th:block>
</body>

<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script>
    let memberId = $("input[name='memberId']").val();
    let memberCategory = $("input[name='memberCategory']").val();
    let check = $("input[name='check']").val();
</script>
<script src="/js/Program/programDetail.js"></script>
<script src="/js/fix/headerLogin.js"></script>
<script>
    let programMemberCount = [[${program.programMemberCount}]];
    let programLimitCount = [[${program.programLimitCount}]];
    // let check = [[${check}]]; // 신청가능/ 불가 (model 객체 사용) 위에 사용

    /* ProgramDetail-신청하기 -> ProgramDetail-Modal 신청하기 클릭시 */
    function insertProgram() {
        let memberId = $('.memberIdSession').attr('href');
        let programId = $('.programId').attr('href');
        let programStatus = $(".programStatus").attr('href');
        // alert(check);
        // alert(memberId);
        // console.log(memberId);
        if (memberId == undefined || check == undefined) {
            // 로그인 필요 모달창 띄우기
            $('.swal2-container').css('display', 'block').fadeIn();
        } else if(programStatus == '마감') {
            alert("이미 마감된 프로그램입니다.")
        } else if(programStatus == '모집예정'){
            alert("모집 예정 프로그램입니다.")
        } else if(check == 'false'){ /*문자열로 인식*/
            alert("이미 신청한 프로그램입니다.")
        } else if(programMemberCount == programLimitCount){
            alert("모집 인원이 가득찬 프로그램입니다.")
        } else {
            // 신청하기 눌렀을 때 memberId가 있다면(로그인이 되어있다면?) 경로로 보내줌
            location.href = "/program/saveMember" + "?programId=" + programId + "&memberId=" + memberId;
        }
    }

    /* 로그인이 안되어있을 경우 _ 로그인/회원가입 창으로 가기 */
    function goLogin() {
        location.href = "/login/login";
    }


</script>

</html>